<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Contrasts for lm, glm, lme, and geeglm objects — esticon • doBy</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Contrasts for lm, glm, lme, and geeglm objects — esticon"><meta property="og:description" content="Computes linear functions (i.e. weighted sums) of the
estimated regression parameters. Can also test the hypothesis,
that such a function is equal to a specific value."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">doBy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.7.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/hojsgaard/doBy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Contrasts for lm, glm, lme, and geeglm objects</h1>
    <small class="dont-index">Source: <a href="https://github.com/hojsgaard/doBy/blob/HEAD/R/esticon.R" class="external-link"><code>R/esticon.R</code></a></small>
    <div class="hidden name"><code>esticon.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes linear functions (i.e. weighted sums) of the
estimated regression parameters. Can also test the hypothesis,
that such a function is equal to a specific value.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">esticon</span><span class="op">(</span><span class="va">obj</span>, <span class="va">L</span>, <span class="va">beta0</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, level <span class="op">=</span> <span class="fl">0.95</span>, joint.test <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'esticon_class'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'esticon_class'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'esticon_class'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">parm</span>, level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'esticon_class'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>Regression object (of type lm, glm, lme, geeglm).</p></dd>


<dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>Matrix (or vector) specifying linear functions of the regression
parameters (one
linear function per row).  The number of columns must match the number of
fitted regression parameters in the model. See 'details' below.</p></dd>


<dt id="arg-beta-">beta0<a class="anchor" aria-label="anchor" href="#arg-beta-"></a></dt>
<dd><p>A vector of numbers</p></dd>


<dt id="arg-conf-int">conf.int<a class="anchor" aria-label="anchor" href="#arg-conf-int"></a></dt>
<dd><p>TRUE</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>The confidence level</p></dd>


<dt id="arg-joint-test">joint.test<a class="anchor" aria-label="anchor" href="#arg-joint-test"></a></dt>
<dd><p>Logical value. If TRUE a 'joint' Wald test for the
hypothesis L beta = beta0 is made. Default is that the 'row-wise' tests are
made, i.e. (L beta)i=beta0i.  If joint.test is TRUE, then no confidence
interval etc. is calculated.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments; currently not used.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An <code>esticon_class</code> object.</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector
of names.  If missing, all parameters are considered.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a matrix with one row per linear function.  Columns contain
estimated coefficients, standard errors, t values, degrees of freedom,
two-sided p-values, and the lower and upper endpoints of the 1-alpha
confidence intervals.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Let the estimated parameters of the model be
$$\beta_1, \beta_2, \dots, \beta_p$$</p>
<p>A linear function of the estimates is of the form $$l=\lambda_1
    \beta_1+\lambda_2 \beta_2+ \dots+\lambda_p \beta_p$$ where
\(\lambda_1, \lambda_2, \dots,\lambda_p\) is specified by the
user.</p>
<p>The esticon function calculates l, its standard error and by default also a
95 pct confidence interval.  It is sometimes of interest to test the
hypothesis \(H_0: l=\beta_0\) for some value \(\beta_0\)
given by the user. A test is provided for the hypothesis \(H_0:
l=0\) but other values of \(\beta_0\) can be specified.</p>
<p>In general, one can specify r such linear functions at one time by
specifying L to be an \(r\times p\) matrix where each row consists
of p numbers \(\lambda_1,\lambda_2,\dots, \lambda_p\). Default is
then that \(\beta_0\) is a p vector of 0s but other values can be
given.</p>
<p>It is possible to test simultaneously that all specified linear functions
are equal to the corresponding values in \(\beta_0\).</p>
<p>For computing contrasts among levels of a single factor, 'contrast.lm' may
be more convenient.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Søren Højsgaard, <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lm1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">Sepal.Width</span> <span class="op">:</span> <span class="va">Species</span>, data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Note that the setosa parameters are set to zero</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   (Intercept)                   Sepal.Width </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     2.6390012                     0.6904897 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Speciesversicolor              Speciesvirginica </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.9007335                     1.2678352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width:Speciesversicolor  Sepal.Width:Speciesvirginica </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.1745880                     0.2110448 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate the intercept for versicolor</span></span></span>
<span class="r-in"><span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">esticon</span><span class="op">(</span><span class="va">lm1</span>, L<span class="op">=</span><span class="va">lambda1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate  std.error  statistic    p.value      beta0  df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 3.5397e+00 5.5802e-01 6.3434e+00 2.7352e-09 0.0000e+00 144</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate the difference between versicolor and virgica intercept</span></span></span>
<span class="r-in"><span><span class="co">## and test if the difference is 1</span></span></span>
<span class="r-in"><span><span class="va">lambda2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">esticon</span><span class="op">(</span><span class="va">lm1</span>, L<span class="op">=</span><span class="va">lambda2</span>, beta0<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      estimate std.error statistic  p.value    beta0  df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.21024   0.69077  -1.75202  0.08190  1.00000 144</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Do both estimates at one time</span></span></span>
<span class="r-in"><span><span class="fu">esticon</span><span class="op">(</span><span class="va">lm1</span>, L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lambda1</span>, <span class="va">lambda2</span><span class="op">)</span>, beta0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            estimate   std.error   statistic     p.value       beta0  df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda1  3.5397e+00  5.5802e-01  6.3434e+00  2.7352e-09  0.0000e+00 144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda2 -2.1024e-01  6.9077e-01 -1.7520e+00  8.1900e-02  1.0000e+00 144</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Make a combined test for that the difference between versicolor and virgica intercept</span></span></span>
<span class="r-in"><span><span class="co">## and difference between versicolor and virginica slope is zero:</span></span></span>
<span class="r-in"><span><span class="va">lambda3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">esticon</span><span class="op">(</span><span class="va">lm1</span>, L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lambda2</span>, <span class="va">lambda3</span><span class="op">)</span>, joint.test<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      X2.stat DF Pr(&gt;|X^2|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.09560902  2  0.9533201</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example using esticon on coxph objects (thanks to Alessandro A. Leidi).</span></span></span>
<span class="r-in"><span><span class="co"># Using dataset 'veteran' in the survival package</span></span></span>
<span class="r-in"><span><span class="co"># from the Veterans' Administration Lung Cancer study</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">veteran</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">veteran</span>, <span class="va">class</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">veteran</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">veteran</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">veteran.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coxmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="va">veteran.s</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">celltype</span> <span class="op">+</span> <span class="va">trt</span>, method<span class="op">=</span><span class="st">'breslow'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">coxmod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare a subject 50 years old with celltype 1</span></span></span>
<span class="r-in"><span><span class="co"># to a subject 70 years old with celltype 2</span></span></span>
<span class="r-in"><span><span class="co"># both subjects on the same treatment</span></span></span>
<span class="r-in"><span><span class="va">AvB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare a subject 40 years old with celltype 2 on treat=0</span></span></span>
<span class="r-in"><span><span class="co"># to a subject 35 years old with celltype 3 on treat=1</span></span></span>
<span class="r-in"><span><span class="va">CvB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">esticon</span><span class="op">(</span><span class="va">coxmod</span>, L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">AvB</span>, <span class="va">CvB</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span></span></span>
<span class="r-in"><span><span class="co">##exp(est[, c(2, 7, 8)])</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: survival</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data set ‘veteran’ not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        estimate   std.error   statistic     p.value       beta0 df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AvB -1.15579745  0.31242070 13.68623052  0.00021603  0.00000000  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CvB -0.24580560  0.28171444  0.76131664  0.38291680  0.00000000  1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ulrich Halekoh, Søren Højsgaard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

