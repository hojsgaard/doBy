<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>doby: Groupwise computations and miscellaneous utilities • doBy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="doby: Groupwise computations and miscellaneous utilities">
<meta property="og:description" content="doBy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">doBy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.6.22</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/doby.html">doby: Groupwise computations and miscellaneous utilities</a>
    </li>
    <li>
      <a href="../articles/model_stability.html">Stability selection</a>
    </li>
    <li>
      <a href="../articles/section_fun.html">Sectioning a function</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>doby: Groupwise computations and miscellaneous
utilities</h1>
                        <h4 data-toc-skip class="author">Søren
Højsgaard</h4>
            
      
      
      <div class="hidden name"><code>doby.rmd</code></div>

    </div>

    
    
<p>The package contains a variety of utility functions. This working
document describes some of these functions. The package originally grew
out of a need to calculate groupwise summary statistics (much in the
spirit of of the system), but today the package contains many different
utilities.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">doBy</span><span class="op">)</span></span></code></pre></div>
<p>The description of the package is based on the dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Porsche 914-2  26.0   4 120.3  91 4.43 2.14 16.7  0  1    5    2</span></span>
<span><span class="co">#&gt; Lotus Europa   30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span></span>
<span><span class="co">#&gt; Ford Pantera L 15.8   8 351.0 264 4.22 3.17 14.5  0  1    5    4</span></span>
<span><span class="co">#&gt; Ferrari Dino   19.7   6 145.0 175 3.62 2.77 15.5  0  1    5    6</span></span>
<span><span class="co">#&gt; Maserati Bora  15.0   8 301.0 335 3.54 3.57 14.6  0  1    5    8</span></span>
<span><span class="co">#&gt; Volvo 142E     21.4   4 121.0 109 4.11 2.78 18.6  1  1    4    2</span></span></code></pre></div>
<p>A description of the variable names can be found here: ; see also
.</p>
<div class="section level2">
<h2 id="groupwise-computations">Groupwise computations<a class="anchor" aria-label="anchor" href="#groupwise-computations"></a>
</h2>
<div class="section level3">
<h3 id="summaryby-and-summary_by">summaryBy() and summary_by()<a class="anchor" aria-label="anchor" href="#summaryby-and-summary_by"></a>
</h3>
<p></p>
<p>The function is used for calculating quantities like ``the mean and
variance of numerical variables <span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span> for each combination of two
factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>’’. Notice: A functionality similar to
 is provided by from base .</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfun1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, s<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/by-summary.html">summaryBy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span>, lh<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">vs</span>, </span>
<span>          data<span class="op">=</span><span class="va">mtcars</span>, FUN<span class="op">=</span><span class="va">myfun1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   vs mpg.m mpg.s cyl.m cyl.s lh.m  lh.s</span></span>
<span><span class="co">#&gt; 1  0  16.6  3.86  7.44 1.149 5.20 0.330</span></span>
<span><span class="co">#&gt; 2  1  24.6  5.38  4.57 0.938 4.48 0.289</span></span></code></pre></div>
<p>A simpler call is</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/by-summary.html">summaryBy</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">vs</span>, data<span class="op">=</span><span class="va">mtcars</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;   vs mpg.mean</span></span>
<span><span class="co">#&gt; 1  0     16.6</span></span>
<span><span class="co">#&gt; 2  1     24.6</span></span></code></pre></div>
<p>Instead of formula we may specify a list containing the left hand
side and the right hand side of a formula but that is possible only for
variables already in the dataframe:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/by-summary.html">summaryBy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"cyl"</span><span class="op">)</span>, <span class="st">"vs"</span><span class="op">)</span>, </span>
<span>          data<span class="op">=</span><span class="va">mtcars</span>, FUN<span class="op">=</span><span class="va">myfun1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   vs mpg.m mpg.s cyl.m cyl.s</span></span>
<span><span class="co">#&gt; 1  0  16.6  3.86  7.44 1.149</span></span>
<span><span class="co">#&gt; 2  1  24.6  5.38  4.57 0.938</span></span></code></pre></div>
<p>Inspired by the package, there is a function which does the samme as
but with the data argument being the first so that one may write</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-summary.html">summary_by</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span>, lh<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">vs</span>,</span>
<span>                      FUN<span class="op">=</span><span class="va">myfun1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   vs mpg.m mpg.s cyl.m cyl.s lh.m  lh.s</span></span>
<span><span class="co">#&gt; 1  0  16.6  3.86  7.44 1.149 5.20 0.330</span></span>
<span><span class="co">#&gt; 2  1  24.6  5.38  4.57 0.938 4.48 0.289</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="orderby-and-order_by">orderBy() and order_by()<a class="anchor" aria-label="anchor" href="#orderby-and-order_by"></a>
</h3>
<p>Ordering (or sorting) a data frame is possible with the function. For
example, we order the rows according to and (within ):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-order.html">orderBy</a></span><span class="op">(</span><span class="op">~</span> <span class="va">gear</span> <span class="op">+</span> <span class="va">carb</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; Toyota Corona     21.5   4  120  97 3.70 2.46 20.0  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Lotus Europa   30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span></span>
<span><span class="co">#&gt; Ford Pantera L 15.8   8 351.0 264 4.22 3.17 14.5  0  1    5    4</span></span>
<span><span class="co">#&gt; Ferrari Dino   19.7   6 145.0 175 3.62 2.77 15.5  0  1    5    6</span></span>
<span><span class="co">#&gt; Maserati Bora  15.0   8 301.0 335 3.54 3.57 14.6  0  1    5    8</span></span></code></pre></div>
<p>If we want the ordering to be by decreasing values of one of the
variables, we can do</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-order.html">orderBy</a></span><span class="op">(</span><span class="op">~</span> <span class="op">-</span><span class="va">gear</span> <span class="op">+</span> <span class="va">carb</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p>Alternative forms are:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-order.html">orderBy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gear"</span>, <span class="st">"carb"</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-order.html">orderBy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-gear"</span>, <span class="st">"carb"</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">x5</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-order.html">order_by</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gear"</span>, <span class="st">"carb"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x6</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-order.html">order_by</a></span><span class="op">(</span><span class="op">~</span> <span class="op">-</span><span class="va">gear</span> <span class="op">+</span> <span class="va">carb</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="splitby-and-split_by">splitBy() and split_by()<a class="anchor" aria-label="anchor" href="#splitby-and-split_by"></a>
</h3>
<p>Suppose we want to split the data into a list of dataframes, e.g. one
dataframe for each month. This can be achieved by:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-split.html">splitBy</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Month</span>, data<span class="op">=</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-split.html">splitBy</a></span><span class="op">(</span><span class="op">~</span> <span class="va">vs</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">head</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`0`</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Duster 360        14.3   8  360 245 3.21 3.57 15.8  0  0    3    4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;                 mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Datsun 710     22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive 21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Valiant        18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; Merc 240D      24.4   4  147  62 3.69 3.19 20.0  1  0    4    2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; $names</span></span>
<span><span class="co">#&gt; [1] "0" "1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $groupid</span></span>
<span><span class="co">#&gt;   vs</span></span>
<span><span class="co">#&gt; 1  0</span></span>
<span><span class="co">#&gt; 2  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $idxvec</span></span>
<span><span class="co">#&gt; $idxvec$`0`</span></span>
<span><span class="co">#&gt;  [1]  1  2  5  7 12 13 14 15 16 17 22 23 24 25 27 29 30 31</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $idxvec$`1`</span></span>
<span><span class="co">#&gt;  [1]  3  4  6  8  9 10 11 18 19 20 21 26 28 32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grps</span></span>
<span><span class="co">#&gt;  [1] "0" "0" "1" "1" "0" "1" "0" "1" "1" "1" "1" "0" "0" "0" "0" "0" "0" "1" "1"</span></span>
<span><span class="co">#&gt; [20] "1" "1" "0" "0" "0" "0" "1" "0" "1" "0" "0" "0" "1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $class</span></span>
<span><span class="co">#&gt; [1] "splitByData" "list"</span></span></code></pre></div>
<p>Alternative forms are:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/by-split.html">splitBy</a></span><span class="op">(</span><span class="st">"vs"</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co">#&gt;   listentry vs</span></span>
<span><span class="co">#&gt; 1         0  0</span></span>
<span><span class="co">#&gt; 2         1  1</span></span>
<span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-split.html">split_by</a></span><span class="op">(</span><span class="op">~</span> <span class="va">vs</span><span class="op">)</span></span>
<span><span class="co">#&gt;   listentry vs</span></span>
<span><span class="co">#&gt; 1         0  0</span></span>
<span><span class="co">#&gt; 2         1  1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subsetby-and-subset_by">subsetBy() and subset_by()<a class="anchor" aria-label="anchor" href="#subsetby-and-subset_by"></a>
</h3>
<p>Suppose we want to select those rows within each month for which the
the wind speed is larger than the mean wind speed (within the month).
This is achieved by:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-subset.html">subsetBy</a></span><span class="op">(</span><span class="op">~</span><span class="va">am</span>, subset<span class="op">=</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; 1.Fiat 128       32.4   4  78.7  66 4.08 2.20 19.5  1  1    4    1</span></span>
<span><span class="co">#&gt; 1.Honda Civic    30.4   4  75.7  52 4.93 1.61 18.5  1  1    4    2</span></span>
<span><span class="co">#&gt; 1.Toyota Corolla 33.9   4  71.1  65 4.22 1.83 19.9  1  1    4    1</span></span>
<span><span class="co">#&gt; 1.Fiat X1-9      27.3   4  79.0  66 4.08 1.94 18.9  1  1    4    1</span></span>
<span><span class="co">#&gt; 1.Porsche 914-2  26.0   4 120.3  91 4.43 2.14 16.7  0  1    5    2</span></span>
<span><span class="co">#&gt; 1.Lotus Europa   30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span></span></code></pre></div>
<p>Note that the statement is evaluated within each month.</p>
<p>Alternative forms are</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-subset.html">subsetBy</a></span><span class="op">(</span><span class="st">"am"</span>, subset<span class="op">=</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>  <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-subset.html">subset_by</a></span><span class="op">(</span><span class="st">"vs"</span>, subset<span class="op">=</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>  <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-subset.html">subset_by</a></span><span class="op">(</span><span class="op">~</span><span class="va">vs</span>, subset<span class="op">=</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="transformby-and-transform_by">transformBy() and transform_by()<a class="anchor" aria-label="anchor" href="#transformby-and-transform_by"></a>
</h3>
<p>The function is analogous to the function except that it works within
groups. For example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; 0.Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; 0.Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; 0.Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; 0.Merc 450SL        17.3   8  276 180 3.07 3.73 17.6  0  0    3    3</span></span>
<span><span class="co">#&gt; 0.Pontiac Firebird  19.2   8  400 175 3.08 3.85 17.1  0  0    3    2</span></span>
<span><span class="co">#&gt; 0.Porsche 914-2     26.0   4  120  91 4.43 2.14 16.7  0  1    5    2</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-transform.html">transformBy</a></span><span class="op">(</span><span class="op">~</span><span class="va">vs</span>, data<span class="op">=</span><span class="va">mtcars</span>, </span>
<span>                 min.mpg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>, max.mpg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;    mpg cyl disp  hp drat   wt qsec vs am gear carb min.mpg max.mpg</span></span>
<span><span class="co">#&gt; 1 21.0   6  160 110 3.90 2.62 16.5  0  1    4    4    10.4      26</span></span>
<span><span class="co">#&gt; 2 21.0   6  160 110 3.90 2.88 17.0  0  1    4    4    10.4      26</span></span>
<span><span class="co">#&gt; 3 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2    10.4      26</span></span>
<span><span class="co">#&gt; 4 14.3   8  360 245 3.21 3.57 15.8  0  0    3    4    10.4      26</span></span>
<span><span class="co">#&gt; 5 16.4   8  276 180 3.07 4.07 17.4  0  0    3    3    10.4      26</span></span>
<span><span class="co">#&gt; 6 17.3   8  276 180 3.07 3.73 17.6  0  0    3    3    10.4      26</span></span></code></pre></div>
<p>Alternative forms:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/by-transform.html">transformBy</a></span><span class="op">(</span><span class="st">"vs"</span>, data<span class="op">=</span><span class="va">mtcars</span>, </span>
<span>                 min.mpg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>, max.mpg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/by-transform.html">transform_by</a></span><span class="op">(</span><span class="st">"vs"</span>,</span>
<span>                             min.mpg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span>, max.mpg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="lapplyby-and-lapply_by">lapplyBy() and lapply_by()<a class="anchor" aria-label="anchor" href="#lapplyby-and-lapply_by"></a>
</h3>
<p>This function is a wrapper for first splitting data into a list
according to the formula (using splitBy) and then applying a function to
each element of the list (using lapply).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/by-lapply.html">lapplyBy</a></span><span class="op">(</span><span class="op">~</span><span class="va">vs</span>, data<span class="op">=</span><span class="va">mtcars</span>,</span>
<span>         FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">~</span><span class="va">cyl</span>, data<span class="op">=</span><span class="va">d</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`0`</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)    36.93       3.69   10.01 2.73e-08</span></span>
<span><span class="co">#&gt; cyl            -2.73       0.49   -5.56 4.27e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)     41.9       5.78    7.26  0.00001</span></span>
<span><span class="co">#&gt; cyl             -3.8       1.24   -3.07  0.00978</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="miscellaneous-utilities">Miscellaneous utilities<a class="anchor" aria-label="anchor" href="#miscellaneous-utilities"></a>
</h2>
<div class="section level3">
<h3 id="firstobs-and-lastobs">firstobs() and lastobs()<a class="anchor" aria-label="anchor" href="#firstobs-and-lastobs"></a>
</h3>
<p>To obtain the indices of the first/last occurences of an item in a
vector do:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/firstlastobs.html">firstobs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  1  4 10</span></span>
<span><span class="fu"><a href="../reference/firstlastobs.html">lastobs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  6  9 10</span></span></code></pre></div>
<p>The same can be done on variables in a data frame, e.g.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/firstlastobs.html">firstobs</a></span><span class="op">(</span><span class="op">~</span><span class="va">vs</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 3</span></span>
<span><span class="fu"><a href="../reference/firstlastobs.html">lastobs</a></span><span class="op">(</span><span class="op">~</span><span class="va">vs</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 31 32</span></span></code></pre></div>
<p>The location of the <span class="math inline">\(n\)</span> largest /
smallest entries in a numeric vector can be obtained with</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">11</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/which.maxn.html">which.maxn</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11 10  4</span></span>
<span><span class="fu"><a href="../reference/which.maxn.html">which.minn</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5 1 6 2 7</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subsequences---subseq">Subsequences - subSeq()<a class="anchor" aria-label="anchor" href="#subsequences---subseq"></a>
</h3>
<p>Find (sub) sequences in a vector:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sub_seq.html">subSeq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;   first last slength midpoint value</span></span>
<span><span class="co">#&gt; 1     1    2       2        2     1</span></span>
<span><span class="co">#&gt; 2     3    5       3        4     2</span></span>
<span><span class="co">#&gt; 3     6    7       2        7     1</span></span>
<span><span class="co">#&gt; 4     8   11       4       10     3</span></span>
<span><span class="co">#&gt; 5    12   14       3       13     1</span></span>
<span><span class="fu"><a href="../reference/sub_seq.html">subSeq</a></span><span class="op">(</span><span class="va">x</span>, item<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   first last slength midpoint value</span></span>
<span><span class="co">#&gt; 1     1    2       2        2     1</span></span>
<span><span class="co">#&gt; 2     6    7       2        7     1</span></span>
<span><span class="co">#&gt; 3    12   14       3       13     1</span></span>
<span><span class="fu"><a href="../reference/sub_seq.html">subSeq</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   first last slength midpoint value</span></span>
<span><span class="co">#&gt; 1     1    2       2        2     a</span></span>
<span><span class="co">#&gt; 2     3    5       3        4     b</span></span>
<span><span class="co">#&gt; 3     6    7       2        7     a</span></span>
<span><span class="co">#&gt; 4     8   11       4       10     c</span></span>
<span><span class="co">#&gt; 5    12   14       3       13     a</span></span>
<span><span class="fu"><a href="../reference/sub_seq.html">subSeq</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>, item<span class="op">=</span><span class="st">"a"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   first last slength midpoint value</span></span>
<span><span class="co">#&gt; 1     1    2       2        2     a</span></span>
<span><span class="co">#&gt; 2     6    7       2        7     a</span></span>
<span><span class="co">#&gt; 3    12   14       3       13     a</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recoding-values-of-a-vector---recodevar">Recoding values of a vector - recodeVar()<a class="anchor" aria-label="anchor" href="#recoding-values-of-a-vector---recodevar"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dec"</span>, <span class="st">"jan"</span>, <span class="st">"feb"</span>, <span class="st">"mar"</span>, <span class="st">"apr"</span>, <span class="st">"may"</span><span class="op">)</span></span>
<span><span class="va">src1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dec"</span>, <span class="st">"jan"</span>, <span class="st">"feb"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mar"</span>, <span class="st">"apr"</span>, <span class="st">"may"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tgt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"winter"</span>, <span class="st">"spring"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/recodeVar.html">recodeVar</a></span><span class="op">(</span><span class="va">x</span>, src<span class="op">=</span><span class="va">src1</span>, tgt<span class="op">=</span><span class="va">tgt1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "winter" "winter" "winter" "spring" "spring" "spring"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-columns-of-a-dataframe-or-matrix---renamecol">Renaming columns of a dataframe or matrix - renameCol()<a class="anchor" aria-label="anchor" href="#renaming-columns-of-a-dataframe-or-matrix---renamecol"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/renameCol.html">renameCol</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vs"</span>, <span class="st">"mpg"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vs_"</span>, <span class="st">"mpg_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   mpg_ cyl disp  hp drat   wt qsec vs_ am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5   0  1    4    4</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0   0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.32 18.6   1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4   1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0   0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2   1  0    3    1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="time-since-an-event---timesinceevent">Time since an event - timeSinceEvent()<a class="anchor" aria-label="anchor" href="#time-since-an-event---timesinceevent"></a>
</h3>
<p>Consider the vector</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Imagine that “1” indicates an event of some kind which takes place at
a certain time point. By default time points are assumed equidistant but
for illustration we define time time variable</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">yvar</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p>Now we find time since event as</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/timeSinceEvent.html">timeSinceEvent</a></span><span class="op">(</span><span class="va">yvar</span>, <span class="va">tvar</span><span class="op">)</span></span>
<span><span class="va">tse</span></span>
<span><span class="co">#&gt;    yvar tvar abs.tse sign.tse ewin run tae  tbe</span></span>
<span><span class="co">#&gt; 1     0  1.1     3.1     -3.1    1  NA  NA -3.1</span></span>
<span><span class="co">#&gt; 2     0  2.2     2.0     -2.0    1  NA  NA -2.0</span></span>
<span><span class="co">#&gt; 3     0  3.1     1.1     -1.1    1  NA  NA -1.1</span></span>
<span><span class="co">#&gt; 4     1  4.2     0.0      0.0    1   1 0.0  0.0</span></span>
<span><span class="co">#&gt; 5     0  5.1     0.9      0.9    1   1 0.9 -5.1</span></span>
<span><span class="co">#&gt; 6     0  6.2     2.0      2.0    1   1 2.0 -4.0</span></span>
<span><span class="co">#&gt; 7     0  7.1     2.9      2.9    1   1 2.9 -3.1</span></span>
<span><span class="co">#&gt; 8     0  8.2     2.0     -2.0    2   1 4.0 -2.0</span></span>
<span><span class="co">#&gt; 9     0  9.1     1.1     -1.1    2   1 4.9 -1.1</span></span>
<span><span class="co">#&gt; 10    1 10.2     0.0      0.0    2   2 0.0  0.0</span></span>
<span><span class="co">#&gt; 11    0 11.1     0.9      0.9    2   2 0.9 -3.1</span></span>
<span><span class="co">#&gt; 12    0 12.2     2.0      2.0    2   2 2.0 -2.0</span></span>
<span><span class="co">#&gt; 13    0 13.1     1.1     -1.1    3   2 2.9 -1.1</span></span>
<span><span class="co">#&gt; 14    1 14.2     0.0      0.0    3   3 0.0  0.0</span></span>
<span><span class="co">#&gt; 15    1 15.1     0.0      0.0    4   4 0.0  0.0</span></span>
<span><span class="co">#&gt; 16    0 16.2     1.1      1.1    4   4 1.1   NA</span></span>
<span><span class="co">#&gt; 17    0 17.1     2.0      2.0    4   4 2.0   NA</span></span>
<span><span class="co">#&gt; 18    0 18.2     3.1      3.1    4   4 3.1   NA</span></span>
<span><span class="co">#&gt; 19    0 19.1     4.0      4.0    4   4 4.0   NA</span></span>
<span><span class="co">#&gt; 20    0 20.2     5.1      5.1    4   4 5.1   NA</span></span></code></pre></div>
The output reads as follows:
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sign.tse</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">tse</span><span class="op">$</span><span class="va">tvar</span><span class="op">[</span><span class="va">tse</span><span class="op">$</span><span class="va">yvar</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"blue"</span>,lwd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">tse</span><span class="op">$</span><span class="va">run</span><span class="op">)</span>, col<span class="op">=</span><span class="va">tse</span><span class="op">$</span><span class="va">run</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">abs.tse</span> <span class="op">+</span> <span class="fl">.2</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, type<span class="op">=</span><span class="st">"b"</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tae</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tbe</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, type<span class="op">=</span><span class="st">"b"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">tse</span><span class="op">$</span><span class="va">tvar</span><span class="op">[</span><span class="va">tse</span><span class="op">$</span><span class="va">yvar</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">run</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, col<span class="op">=</span><span class="st">"cyan"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ewin</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">tse</span><span class="op">$</span><span class="va">tvar</span><span class="op">[</span><span class="va">tse</span><span class="op">$</span><span class="va">yvar</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">run</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>We may now find times for which time since an event is at most 1
as</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse</span><span class="op">$</span><span class="va">tvar</span><span class="op">[</span><span class="va">tse</span><span class="op">$</span><span class="va">abs</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  4.2  5.1 10.2 11.1 14.2 15.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-using-subseq-and-timesinceevent">Example: Using subSeq() and timeSinceEvent()<a class="anchor" aria-label="anchor" href="#example-using-subseq-and-timesinceevent"></a>
</h3>
<p>Consider the data:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lynx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span></span>
<span><span class="va">tvar</span> <span class="op">&lt;-</span> <span class="fl">1821</span><span class="op">:</span><span class="fl">1934</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tvar</span>, <span class="va">lynx</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>Suppose we want to estimate the cycle lengths. One way of doing this
is as follows:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yyy</span> <span class="op">&lt;-</span> <span class="va">lynx</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">yyy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE  TRUE</span></span>
<span><span class="va">sss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sub_seq.html">subSeq</a></span><span class="op">(</span><span class="va">yyy</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sss</span></span>
<span><span class="co">#&gt;    first last slength midpoint value</span></span>
<span><span class="co">#&gt; 1      6   10       5        8  TRUE</span></span>
<span><span class="co">#&gt; 2     16   19       4       18  TRUE</span></span>
<span><span class="co">#&gt; 3     27   28       2       28  TRUE</span></span>
<span><span class="co">#&gt; 4     35   38       4       37  TRUE</span></span>
<span><span class="co">#&gt; 5     44   47       4       46  TRUE</span></span>
<span><span class="co">#&gt; 6     53   55       3       54  TRUE</span></span>
<span><span class="co">#&gt; 7     63   66       4       65  TRUE</span></span>
<span><span class="co">#&gt; 8     75   76       2       76  TRUE</span></span>
<span><span class="co">#&gt; 9     83   87       5       85  TRUE</span></span>
<span><span class="co">#&gt; 10    92   96       5       94  TRUE</span></span>
<span><span class="co">#&gt; 11   104  106       3      105  TRUE</span></span>
<span><span class="co">#&gt; 12   112  114       3      113  TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tvar</span>, <span class="va">lynx</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">tvar</span><span class="op">[</span><span class="va">sss</span><span class="op">$</span><span class="va">midpoint</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>Create the “event vector”</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yvar</span><span class="op">[</span><span class="va">sss</span><span class="op">$</span><span class="va">midpoint</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">yvar</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:114] 0 0 0 0 0 0 0 1 0 0 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/timeSinceEvent.html">timeSinceEvent</a></span><span class="op">(</span><span class="va">yvar</span>,<span class="va">tvar</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tse</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;    yvar tvar abs.tse sign.tse ewin run tae tbe</span></span>
<span><span class="co">#&gt; 1     0 1821       7       -7    1  NA  NA  -7</span></span>
<span><span class="co">#&gt; 2     0 1822       6       -6    1  NA  NA  -6</span></span>
<span><span class="co">#&gt; 3     0 1823       5       -5    1  NA  NA  -5</span></span>
<span><span class="co">#&gt; 4     0 1824       4       -4    1  NA  NA  -4</span></span>
<span><span class="co">#&gt; 5     0 1825       3       -3    1  NA  NA  -3</span></span>
<span><span class="co">#&gt; 6     0 1826       2       -2    1  NA  NA  -2</span></span>
<span><span class="co">#&gt; 7     0 1827       1       -1    1  NA  NA  -1</span></span>
<span><span class="co">#&gt; 8     1 1828       0        0    1   1   0   0</span></span>
<span><span class="co">#&gt; 9     0 1829       1        1    1   1   1  -9</span></span>
<span><span class="co">#&gt; 10    0 1830       2        2    1   1   2  -8</span></span>
<span><span class="co">#&gt; 11    0 1831       3        3    1   1   3  -7</span></span>
<span><span class="co">#&gt; 12    0 1832       4        4    1   1   4  -6</span></span>
<span><span class="co">#&gt; 13    0 1833       5        5    1   1   5  -5</span></span>
<span><span class="co">#&gt; 14    0 1834       4       -4    2   1   6  -4</span></span>
<span><span class="co">#&gt; 15    0 1835       3       -3    2   1   7  -3</span></span>
<span><span class="co">#&gt; 16    0 1836       2       -2    2   1   8  -2</span></span>
<span><span class="co">#&gt; 17    0 1837       1       -1    2   1   9  -1</span></span>
<span><span class="co">#&gt; 18    1 1838       0        0    2   2   0   0</span></span>
<span><span class="co">#&gt; 19    0 1839       1        1    2   2   1  -9</span></span>
<span><span class="co">#&gt; 20    0 1840       2        2    2   2   2  -8</span></span></code></pre></div>
<p>We get two different (not that different) estimates of period
lengths:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">len1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">tse</span><span class="op">$</span><span class="va">ewin</span>, <span class="va">tse</span><span class="op">$</span><span class="va">ewin</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="va">len2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">tse</span><span class="op">$</span><span class="va">run</span>, <span class="va">tse</span><span class="op">$</span><span class="va">run</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">len1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">len2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">len1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">len2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9.50 9.00 9.50 8.92</span></span></code></pre></div>
<p>We can overlay the cycles as:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse</span><span class="op">$</span><span class="va">lynx</span> <span class="op">&lt;-</span> <span class="va">lynx</span></span>
<span><span class="va">tse2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">tse</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lynx</span> <span class="op">~</span> <span class="va">tae</span>, data<span class="op">=</span><span class="va">tse2</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tvar</span>, <span class="va">lynx</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">lynx</span> <span class="op">~</span> <span class="va">tae</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">tae</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">tae</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>, data<span class="op">=</span><span class="va">tse2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">~</span> <span class="va">tvar</span>, data<span class="op">=</span><span class="va">tse2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="doby_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>Credit is due to Dennis Chabot, Gabor Grothendieck, Paul Murrell and
Jim Robison-Cox for reporting various bugs and making various
suggestions to the functionality in the package.</p>
<!-- ```  -->
<!-- \end{document} -->
<!-- % \appendix -->
<!-- % \section{The data} -->
<!-- % \label{sec:appdata} -->
<!-- % The reduced \code{C02} are: -->
<!-- % ```{r} -->
<!-- % CO2 -->
<!-- % ```  -->
<!-- % The reduced \code{airquality} data are: -->
<!-- % ```{r} -->
<!-- % head(airquality, n=20) -->
<!-- % ```  -->
<!-- % On the to-do-list is to allow to write as follows (but this feature is not -->
<!-- % implemented yet): -->
<!-- % <<eval=F>>=  -->
<!-- % summaryBy(list(c("conc", "uptake", lu="log(uptake)"), "Plant"),  -->
<!-- %           data=CO2, FUN=c(mean, sd)) -->
<!-- % ``` -->
<!-- % Inspired by the \pkg{dplyr} package, there is a \verb|summary_by| function which -->
<!-- % does the samme as \summaryby{} but with the data argument being the first so -->
<!-- % that one may write -->
<!-- % <<results=hide>>=  -->
<!-- % CO2 |> summary_by(cbind(conc, uptake, lu=log(uptake)) ~ Plant,  -->
<!-- %                    FUN=myfun1) -->
<!-- % ``` -->
<!-- % which is the same as writing: -->
<!-- % <<results=hide>>=  -->
<!-- % summary_by(CO2, cbind(conc, uptake, lu=log(uptake)) ~ Plant,  -->
<!-- %            FUN=myfun1) -->
<!-- % ``` -->
<!-- %% Same as -->
<!-- %% <<results=hide>>=  -->
<!-- %% aggregate(cbind(conc, uptake, log(uptake)) ~ Plant, data=CO2, FUN=myfun1) -->
<!-- %% aggregate(conc ~ Plant, data=CO2, FUN=mean) -->
<!-- %% ``` -->
<!-- %%  -->
<!-- %%<< >>=  -->
<!-- %%library(magrittr) -->
<!-- %%CO2 |> summary_by(cbind(conc, uptake) ~ Plant, FUN=myfun1) -->
<!-- %%``` -->
<!-- %% -->
<!-- %% -->
<!-- %%<< >>=  -->
<!-- %%summaryBy2( list(c("conc","uptake"), "Plant"), data=CO2, FUN=myfun1) -->
<!-- %%``` -->
<!-- %% -->
<!-- %% -->
<!-- %%Above \code{myfun1()} is a function that returns a vector of named -->
<!-- %%values. Note that the values returned by the function has been named as -->
<!-- %%\code{m} and \code{v}. An alternative specification is: -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy( list(c("conc","uptake"), "Plant"), data=CO2, FUN=myfun1) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%If the result of the function(s) are not named, then the names in the -->
<!-- %%output data in general become less intuitive: -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%myfun2 <- function(x){c(mean(x), var(x))} -->
<!-- %%summaryBy( conc + uptake ~ Plant, data=CO2, FUN=myfun2) -->
<!-- %%```  -->
<!-- %% -->
<!-- %% -->
<!-- %%Another usage is to specify a list of functions each of which returns -->
<!-- %%a single value: -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryByOLD( conc + uptake ~ Plant, data=CO2, FUN=list( mean, var ) ) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%Notice that if we specify a list of functions of which some returns a -->
<!-- %%vector with more than one element, then the proper names are not -->
<!-- %%retrieved: -->
<!-- %%%%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(uptake~Plant, data=CO2, FUN=list( mean, var, myfun1 )) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%One can ``hard code'' the function names into the output as -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryByOLD(uptake~Plant, data=CO2, FUN=list( mean, var, myfun1 ), -->
<!-- %%          fun.names=c("mean","var","mm","vv")) -->
<!-- %%```  -->
<!-- %% -->
<!-- % \subsubsection{Statistics on functions of data} -->
<!-- % \label{sec:xxx} -->
<!-- % We may want to calculate the mean and variance for the logarithm of -->
<!-- % \code{uptake}, for \code{uptake}+\code{conc} (not likely to be a -->
<!-- % useful statistic) as well as for \code{uptake} and -->
<!-- % \code{conc}. This can be achieved as: -->
<!-- % ``` -->
<!-- % ```{r} -->
<!-- % summaryByOLD(log(uptake) + I(conc+uptake) + conc+uptake ~ Plant, data=CO2, -->
<!-- %           FUN=myfun1) -->
<!-- % ```  -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(cbind(lu=log(uptake), conc + uptake, conc, uptake) ~ Plant, data=CO2, -->
<!-- %%          FUN=myfun1) -->
<!-- %%```  -->
<!-- %% -->
<!-- %% -->
<!-- %% -->
<!-- %%The names of the variables become involved with this. The user may -->
<!-- %%control the names of the variables directly: -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(log(uptake) + I(conc+uptake) + conc + uptake ~ Plant, data=CO2, -->
<!-- %%          FUN=myfun1, var.names=c("log.upt", "conc+upt", "conc", "upt")) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%If one does not want output variables to contain parentheses then -->
<!-- %%setting \code{p2d=TRUE} causes the parentheses to be replaced by dots -->
<!-- %%(``.''). -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(log(uptake)+I(conc+uptake)~Plant, data=CO2, p2d=TRUE, -->
<!-- %%FUN=myfun1) -->
<!-- %%```  -->
<!-- %% -->
<!-- %% -->
<!-- %% -->
<!-- %% -->
<!-- %% -->
<!-- %%\subsubsection{Copying variables out with the \code{id} argument} -->
<!-- %%\label{sec:xxx} -->
<!-- %% -->
<!-- %%To get the value of the \code{Type} and \code{Treat} in the first row of the -->
<!-- %%groups (defined by the values of \code{Plant}) copied to the output -->
<!-- %%dataframe we use the \code{id} argument in one of the following forms: -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(conc+uptake~Plant, data=CO2, FUN=myfun1, id=~Type+Treat) -->
<!-- %%summaryBy(conc+uptake~Plant, data=CO2, FUN=myfun1, id=c("Type","Treat")) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%\subsubsection{Using '.' on the left hand side of a formula} -->
<!-- %%\label{sec:xxx} -->
<!-- %% -->
<!-- %%It is possible  to use the dot (".") on the left hand side of -->
<!-- %%the formula. The dot means "all numerical variables which do not -->
<!-- %%appear elsewhere" (i.e.\ on the right hand side of the formula and in -->
<!-- %%the \code{id} statement): -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(log(uptake)+I(conc+uptake)+. ~Plant, data=CO2, FUN=myfun1) -->
<!-- %%```  -->
<!-- %% -->
<!-- %% -->
<!-- %%\subsubsection{Using '.' on the right hand side of a formula} -->
<!-- %%\label{sec:xxx} -->
<!-- %% -->
<!-- %%The dot (".") can also be used on the right hand side of the formula -->
<!-- %%where it refers to "all non--numerical variables which are not -->
<!-- %%specified elsewhere": -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(log(uptake) ~Plant+., data=CO2, FUN=myfun1) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%\subsubsection{Using '1' on the right hand side of the formula} -->
<!-- %%\label{sec:xxx} -->
<!-- %% -->
<!-- %%Using 1 on the -->
<!-- %%  right hand side means no grouping: -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(log(uptake) ~ 1, data=CO2, FUN=myfun1) -->
<!-- %%```  -->
<!-- %% -->
<!-- %% -->
<!-- %% -->
<!-- %%\subsubsection{Preserving names of variables using \code{keep.names}} -->
<!-- %%\label{sec:xxx} -->
<!-- %%If the function applied to data only returns one value, it is possible -->
<!-- %%to force that the summary variables retain the original names by -->
<!-- %%setting \code{keep.names=TRUE}. A -->
<!-- %%typical use of this could be -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%summaryBy(conc+uptake+log(uptake)~Plant, -->
<!-- %%data=CO2, FUN=mean, id=~Type+Treat, keep.names=TRUE) -->
<!-- %%```  -->
<!-- %% -->
<!-- %%\subsection{The \code{splitBy} function} -->
<!-- %%\label{splitBy} -->
<!-- %% -->
<!-- %%Suppose we want to split the \code{airquality} data into a list of dataframes, e.g.\ one -->
<!-- %%dataframe for each month. This can be achieved by: -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%x<-splitBy(~Month, data=airquality) -->
<!-- %%x -->
<!-- %%```  -->
<!-- %%Hence for month 5, the relevant entry-name in the list is '5' and this -->
<!-- %%part of data  can -->
<!-- %%be extracted as -->
<!-- %%``` -->
<!-- %%%<<eval=F, results=hide>>= -->
<!-- %%%x[['5']] -->
<!-- %%%```  -->
<!-- %% -->
<!-- %%Information about the grouping is stored as a dataframe -->
<!-- %%in an attribute called \code{groupid} and can be retrieved with: -->
<!-- %%```{r} -->
<!-- %%attr(x,"groupid") -->
<!-- %%```  -->
<!-- %% -->
<!-- %% \subsection{The \code{sampleBy} function} -->
<!-- %% \label{sampleBy} -->
<!-- %%  -->
<!-- %% Suppose we want a random sample of 50 \% of the observations from a -->
<!-- %% dataframe. This can be achieved with: -->
<!-- %% ``` -->
<!-- %% <<results=hide>>= -->
<!-- %% sampleBy(~1, frac=0.5, data=airquality) -->
<!-- %% ```  -->
<!-- %%  -->
<!-- %% Suppose instead that we want a  systematic sample of  every fifth -->
<!-- %% observation within each month. This is achieved with: -->
<!-- %% ``` -->
<!-- %% <<results=hide>>= -->
<!-- %% sampleBy(~Month, frac=0.2, data=airquality,systematic=T) -->
<!-- %% ```  -->
<!-- %%  -->
<!-- %%  -->
<!-- %% Inspired by the \pkg{dplyr} package, there is an \verb|order_by| function -->
<!-- %% << >>=  -->
<!-- %% x5 <- airquality |> order_by(c("Temp", "Month")) -->
<!-- %% x6 <- airquality |> order_by(c("-Temp", "Month")) -->
<!-- %% ``` -->
<!-- %% which is the same as -->
<!-- %% << >>=  -->
<!-- %% x5 <- order_by(airquality, c("Temp", "Month")) -->
<!-- %% x6 <- order_by(airquality, c("-Temp", "Month")) -->
<!-- %% ``` -->
<!-- %% <<echo=F, results=hide>>=  -->
<!-- %% c(all.equal(x1, x3), all.equal(x1, x5),  -->
<!-- %%   all.equal(x2, x4), all.equal(x2, x6)) -->
<!-- %% ``` -->
<!-- %% Suppose we want to calculate the weekwise feed efficiency of the pigs -->
<!-- %% in the \code{dietox} data, i.e. weight gain divided by feed intake. -->
<!-- %% ``` -->
<!-- %% ```{r} -->
<!-- %% data(dietox) -->
<!-- %% dietox <- orderBy(~Pig+Time, data=dietox) -->
<!-- %% FEfun  <- function(d){c(NA, diff(d$Weight)/diff(d$Feed))} -->
<!-- %% v      <- lapplyBy(~Pig, data=dietox, FEfun) -->
<!-- %% dietox$FE <- unlist(v) -->
<!-- %% ```  -->
<!-- %%  -->
<!-- %% Technically, the above is the same as -->
<!-- %% ``` -->
<!-- %% ```{r} -->
<!-- %% dietox <- orderBy(~Pig+Time, data=dietox) -->
<!-- %% wdata  <- splitBy(~Pig, data=dietox) -->
<!-- %% v      <- lapply(wdata, FEfun) -->
<!-- %% dietox$FE <- unlist(v) -->
<!-- %% ```  -->
<!-- %%  -->
<!-- %% -->
<!-- %% \subsection{The \code{scaleBy} function} -->
<!-- %%  -->
<!-- %% Standardize the \code{iris} data within each value of \code{"Species"}: -->
<!-- %% ``` -->
<!-- %% ```{r} -->
<!-- %% x <- scaleBy(cbind(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) ~ Species,      -->
<!-- %%              data=iris) -->
<!-- %% lapply(x, head, 4) -->
<!-- %% head(iris) -->
<!-- %% ``` def -->
<!-- %%  -->
<!-- %% Alternative forms: -->
<!-- %% << >>=  -->
<!-- %% x <- scaleBy( list(c("Sepal.Length", "Sepal.Width", "Petal.Length", "Petal.Width"), -->
<!-- %%                  "Species"),     data=iris) -->
<!-- %% x <- scaleBy(. ~ Species, data=iris) -->
<!-- %% x <- scaleBy(list(".", "Species"),  data=iris) -->
<!-- %% x <- iris  >% scale_by(. ~ Species) -->
<!-- %% ``` -->
<!-- %%  -->
<!-- %%\section{Create By--functions on the fly} -->
<!-- %%\label{sec:create-functions-fly} -->
<!-- %% -->
<!-- %%Create a function for creating groupwise t-tests -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%mydata <- data.frame(y=rnorm(32), x=rnorm(32), -->
<!-- %%g1=factor(rep(c(1,2),each=16)), g2=factor(rep(c(1,2), each=8)), -->
<!-- %%g3=factor(rep(c(1,2),each=4))) -->
<!-- %%head(mydata) -->
<!-- %%```  -->
<!-- %% -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%## Based on the formula interface to t.test -->
<!-- %%t.testBy1 <- function(formula, group, data, ...){ -->
<!-- %%  formulaFunBy(formula, group, data, FUN=t.test, class="t.testBy1", ...) -->
<!-- %%} -->
<!-- %%## Based on the default interface to t.test -->
<!-- %%t.testBy2 <- function(formula, group, data, ...){ -->
<!-- %%  xyFunBy(formula, group, data, FUN=t.test, class="t.testBy1", ...) -->
<!-- %%} -->
<!-- %%```  -->
<!-- %% -->
<!-- %%Notice: The optional \code{class} argument will facilitate that you -->
<!-- %%create your own print / summary methods etc. -->
<!-- %% -->
<!-- %%``` -->
<!-- %%```{r} -->
<!-- %%t.testBy1(y~g1, ~g2, data=mydata) -->
<!-- %%t.testBy2(y~x,  ~g2, data=mydata) -->
<!-- %%```  -->
<!-- %% -->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Søren Højsgaard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
