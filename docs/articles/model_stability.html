<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stability selection • doBy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stability selection">
<meta property="og:description" content="doBy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">doBy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.6.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model_stability.html">Stability selection</a>
    </li>
    <li>
      <a href="../articles/section_fun.html">Sectioning a function</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stability selection</h1>
                        <h4 data-toc-skip class="author">Søren
Højsgaard</h4>
            
      
      
      <div class="hidden name"><code>model_stability.rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="stability-selection-differences-in-models-due-to-different-data-sets">Stability selection: differences in models due to different data
sets<a class="anchor" aria-label="anchor" href="#stability-selection-differences-in-models-due-to-different-data-sets"></a>
</h2>
<p>Suppose we have collection of regression models <span class="math inline">\(M_1, M_2, \ldots, M_p\)</span>. By a regression
model we here mean a set of predictors and a model for the response. To
asses the predictive ability of the models we perform cross validation:
Fit each model to one set of data and predict another set of data, do so
repeatedly. Compute a prediction error for each model. The model with
the smallest prediction error is the best model.</p>
<p>But before we get there, we need to select a model to generate the
collection of candidate models. One approach is the following:</p>
<p>A model selection method consists of two parts:</p>
<ol style="list-style-type: decimal">
<li>A criterion for selecting a model and</li>
<li>A strategy for generating candidate models, that is a strategy for
navigating the model space.</li>
</ol>
<p>If we have <span class="math inline">\(K\)</span> datasets we can
perform <span class="math inline">\(K\)</span> model selections, and
this gives us a collection of candidate models. We can then perform
cross validation on these models. Say we want to perform <span class="math inline">\(K\)</span> different model selections. We can do
this by resampling or by creating subgroups. Resampling is done by
drawing <span class="math inline">\(n\)</span> observations with
replacement from the data set. Subgroups are created by dividing the
data set into <span class="math inline">\(K\)</span> subgroups as
follows: Form <span class="math inline">\(K\)</span> subgroups by
dividing the data set into <span class="math inline">\(K\)</span> equal
parts. Then for each <span class="math inline">\(k=1,\ldots,K\)</span>
the <span class="math inline">\(k\)</span>th subgroup is left out and
the model is fitted to the remaining data. Default below is the subgroup
method.</p>
</div>
<div class="section level2">
<h2 id="generating-data-sets">Generating data sets<a class="anchor" aria-label="anchor" href="#generating-data-sets"></a>
</h2>
<p>Consider this subset of the mtcars dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat0</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="op">]</span></span>
<span><span class="va">dat0</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span></code></pre></div>
<p>Generate a list of data sets by resampling or by creating
subgroups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span><span class="va">dat0</span>, K<span class="op">=</span><span class="fl">3</span>, method<span class="op">=</span><span class="st">"subgroups"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;                 mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag  21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710     22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive 21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Valiant        18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="fu"><a href="../reference/generate_data_list.html">generate_data_list</a></span><span class="op">(</span><span class="va">dat0</span>, K<span class="op">=</span><span class="fl">3</span>, method<span class="op">=</span><span class="st">"resample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;                      mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4           21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></span>
<span><span class="co">#&gt; Hornet 4 Drive      21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout   18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Hornet Sportabout.1 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Hornet Sportabout.2 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant             18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Datsun 710.1      22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; Valiant.1         18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;                      mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag       21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></span>
<span><span class="co">#&gt; Hornet 4 Drive      21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive.1    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout   18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Hornet Sportabout.1 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant             18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h2>
<p>Focus on entire dataset. For evaluation of the predictive ability of
the selected model we set 20% of the data aside for validation. Hence we
select models based on the remaining 80% of the data. Fit a linear model
to each data set and select the best model by stepwise regression. This
gives an indication of the stability of the model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1411</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">personality</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fl">0.6</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat.training</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span></span>
<span><span class="va">dat.testing</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">agreebl</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dat.training</span><span class="op">)</span></span></code></pre></div>
<p>For each fold we can select models on the analysis part of the data
set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1411</span><span class="op">)</span></span>
<span><span class="va">n.searches</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">mod_stab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_stability_glm.html">model_stability_glm</a></span><span class="op">(</span><span class="va">dat.training</span>, <span class="va">mod1</span>,</span>
<span>                           n.searches<span class="op">=</span><span class="va">n.searches</span>, method<span class="op">=</span><span class="st">"subgroups"</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">mod_stab</span></span>
<span><span class="co">#&gt; $rhs_matrix</span></span>
<span><span class="co">#&gt; 19 x 12 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                                </span></span>
<span><span class="co">#&gt; distant . . . 1 . . . . . . . .</span></span>
<span><span class="co">#&gt; carelss 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; hardwrk 1 1 1 1 1 . 1 . 1 1 . 1</span></span>
<span><span class="co">#&gt; tense   1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; kind    1 1 1 1 1 . 1 . . . 1 1</span></span>
<span><span class="co">#&gt; relaxed 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; approvn 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; harsh   . 1 1 1 . . 1 1 1 . . .</span></span>
<span><span class="co">#&gt; persevr 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; friendl . 1 1 1 1 1 1 1 1 1 . 1</span></span>
<span><span class="co">#&gt; lazy    . . 1 1 1 . . 1 . . 1 .</span></span>
<span><span class="co">#&gt; coopera 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; quiet   . 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; withdrw . . . 1 . . . . . . . .</span></span>
<span><span class="co">#&gt; disorgn . . . . . 1 . . 1 . . .</span></span>
<span><span class="co">#&gt; respnsi . . . . . 1 1 1 1 1 . 1</span></span>
<span><span class="co">#&gt; contrar . . . . 1 1 . . . 1 . 1</span></span>
<span><span class="co">#&gt; worryin . . . . . . 1 1 1 1 . 1</span></span>
<span><span class="co">#&gt; sociabl . . . . . . . . . . 1 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $freq</span></span>
<span><span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_stab</span><span class="op">)</span></span>
<span><span class="co">#&gt; $number_of_models</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $number_of_unique_models</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $number_of_predictors</span></span>
<span><span class="co">#&gt;  [1]  8 11 12 14 12 11 13 12 13 12 10 14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $frequency_of_predictors</span></span>
<span><span class="co">#&gt; distant carelss hardwrk   tense    kind relaxed approvn   harsh persevr friendl </span></span>
<span><span class="co">#&gt;       1      12       9      12       8      12      12       6      12      10 </span></span>
<span><span class="co">#&gt;    lazy coopera   quiet withdrw disorgn respnsi contrar worryin sociabl </span></span>
<span><span class="co">#&gt;       5      12      11       1       2       6       4       5       2</span></span></code></pre></div>
<p>Specifically, the matrix shows the predictors selected in each model
and below is the frequency with which each model is selected.</p>
<p>The outcome of the steps above is a list of models and as it is the
same model selection method applied to each group of data, the
difference (if any) in models is due to differences in the data in each
group.</p>
<p>We can obtain fitted models as follows</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">mod_stab</span>, fit<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; agreebl ~ carelss + hardwrk + tense + kind + relaxed + approvn + </span></span>
<span><span class="co">#&gt;     persevr + coopera</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5bee1a320a20&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; agreebl ~ carelss + hardwrk + tense + kind + relaxed + approvn + </span></span>
<span><span class="co">#&gt;     harsh + persevr + friendl + coopera + quiet</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5bee1a38ce00&gt;</span></span></code></pre></div>
<p>This gives us a set of candidate models.</p>
</div>
<div class="section level2">
<h2 id="predictive-performance">Predictive performance<a class="anchor" aria-label="anchor" href="#predictive-performance"></a>
</h2>
<p>We have selected a model based on subgroups of the training data. We
can now evaluate the predictive performance of the selected model on the
test data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">mod_stab</span>, fit<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1411</span><span class="op">)</span></span>
<span><span class="va">cv.error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_glm_fitlist.html">cv_glm_fitlist</a></span><span class="op">(</span><span class="va">dat.training</span>, <span class="va">fit_list</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">cv.error</span></span>
<span><span class="co">#&gt;  [1] 1.03 1.13 1.04 1.23 1.10 1.10 0.95 1.01 1.01 1.08 1.16 1.13</span></span>
<span></span>
<span></span>
<span><span class="va">cv3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fit_list</span>, </span>
<span>       <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>         <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit</span>, data<span class="op">=</span><span class="va">dat.training</span><span class="op">)</span></span>
<span>         <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/model-quality.html" class="external-link">rmse</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">dat.testing</span><span class="op">)</span></span>
<span>       <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cv3</span></span>
<span><span class="co">#&gt;  [1] 1.26 1.29 1.30 1.30 1.36 1.36 1.31 1.35 1.36 1.38 1.23 1.36</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.error</span>, <span class="va">cv3</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_stability_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We can now evaluate the predictive performance of the selected model
on the test data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">cv.error</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Subgroups"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv3</span>, main<span class="op">=</span><span class="st">"Subgroups"</span><span class="op">)</span></span></code></pre></div>
<p><img src="model_stability_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The plot on the left shows the cross validation error for the models
selected in the subgroups. The plot on the right shows the prediction
error for the models on the test data.</p>
</div>
<div class="section level2">
<h2 id="stability-selection">Stability selection<a class="anchor" aria-label="anchor" href="#stability-selection"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Søren Højsgaard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
